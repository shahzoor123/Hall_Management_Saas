{% extends 'partials/base.html' %} {% load static %} {% block title%}Dashboard{% endblock title %} {% block extra_css %}
<!-- plugin css -->
<link href="{% static 'libs/admin-resources/jquery.vectormap/jquery-jvectormap-1.2.2.css' %}" rel="stylesheet"
  type="text/css" />




{% endblock extra_css %} {% block content %}



<div class="main-content">
  <div class="page-content">
    <!-- start page title -->
    <div class="page-title-box">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-sm-6">
            <div class="page-title">
              <h4>Finance Dashboard</h4>
              <ol class="breadcrumb m-0">
                <li class="breadcrumb-item">
                  <a href="javascript: void(0);">Hall</a>
                </li>
                <li class="breadcrumb-item">
                  <a href="javascript: void(0);">Dashboard</a>
                </li>
                <li class="breadcrumb-item active">Home</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- end page title -->





    <div class="container_fluid">
      <div class="row">
          <div class="col-md-6 col-sm-12">
              <!-- Element 1 -->
              <div class="card">
                  <div class="card-body">
                      <h4 class="header-title">Monthly Sales</h4>
                      <canvas id="salesChartMonthly"></canvas>
                  </div>
              </div>
          </div>
          <div class="col-md-6 col-sm-12">
              <!-- Element 2 -->
              <div class="card">
                  <div class="card-body">
                      <h4 class= "header-title">Daily Sales</h4>
                      <canvas id="salesChartDaily"></canvas>
                  </div>
              </div>
          </div>
      </div>
      <div class="row">
          <div class="col-md-6 col-sm-12">
              <!-- Element 3 -->
              <div class="card">
                  <div class="card-body">
                      <h4 class="header-title">Monthly Expense</h4>
                      <canvas id="expensesChartMonthly"></canvas>
                  </div>
              </div>
          </div>
          <div class="col-md-6 col-sm-12">
              <!-- Element 4 -->
              <div class="card">
                  <div class="card-body">
                      <h4 class="header-title">Daily Expense</h4>
                      <canvas id="expensesChartDaily"></canvas>
                  </div>
              </div>
          </div>
      </div>
  </div>
  
          
          </div>
        </div> 
      
      </div>
    </div>

  </div>
</div>

<h1 hidden id="sale" data-my-variable="{{sale}}"></h1>
<h1 hidden id="expense" data-my-variable="{{expense}}"></h1>
<!-- End Page-content -->
{% endblock content %} {% block extra_javascript %}


<!-- apexcharts -->
<!-- <script src="{% static 'libs/apexcharts/dist/apexcharts.min.js' %}"></script> -->
<!-- Plugins js-->
<script src="{% static 'libs/admin-resources/jquery.vectormap/jquery-jvectormap-1.2.2.min.js' %}"></script>
<script src="{% static 'libs/admin-resources/jquery.vectormap/maps/jquery-jvectormap-world-mill-en.js' %}"></script>

<!-- <script src="{% static 'js/pages/dashboard.init.js' %}"></script> -->
<script src="{% static 'libs/chart.js/dist/Chart.bundle.min.js' %}"></script>
<script src="{% static 'js/pages/chartjs.init.js' %}"></script>
<script src="{% static 'libs/chartist/dist/chartist.min.js' %}"></script>
<script src="{% static 'libs/chartist-plugin-tooltips-updated/dist/chartist-plugin-tooltip.min.js' %}"></script>
<script src="{% static 'js/pages/chart.js' %}"></script>



<script>


const dailySalesData = {
  'Jan': [10, 20, 15, 30, 25, 12, 18, 5, 0, 0, 0, 0],
  'Feb': [5, 15, 18, 12, 10, 10, 25, 30, 0, 0, 0, 0],
  'Mar': [8, 12, 15, 25, 22, 16, 20, 10, 0, 0, 0, 0],
  'Apr': [12, 18, 20, 22, 30, 28, 24, 15, 0, 0, 0, 0],
  'May': [15, 25, 28, 32, 35, 30, 28, 22, 0, 0, 0, 0],
  'Jun': [20, 30, 35, 40, 42, 38, 32, 30, 0, 0, 0, 0],
  'Jul': [22, 32, 36, 45, 48, 42, 40, 35, 0, 0, 0, 0],
  'Aug': [18, 28, 32, 38, 42, 40, 38, 32, 0, 0, 0, 0],
  'Sep': [10, 20, 25, 28, 30, 32, 28, 25, 0, 0, 0, 0],
  'Oct': [5, 15, 20, 22, 25, 30, 28, 20, 0, 0, 0, 0],
  'Nov': [0, 10, 15, 18, 20, 22, 25, 12, 0, 0, 0, 0],
  'Dec': [0, 5, 10, 12, 15, 18, 20, 8, 0, 0, 0, 0]
};

  // Get the values from the data attributes
  var montly_sale = document.getElementById("sale").getAttribute("data-my-variable");
  var montly_expense = document.getElementById("expense").getAttribute("data-my-variable");



  
  // // Parse the values as JSON arrays
  var totalSales = JSON.parse(montly_sale);
  var totalExpense = JSON.parse(montly_expense);


  const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

  const salesData = Array.from({ length: 12 }, () => Math.floor(Math.random() * 1000));
  const expensesData = Array.from({ length: 12 }, () => Math.floor(Math.random() * 500));

  const salesChartMonthlyCtx = document.getElementById('salesChartMonthly').getContext('2d');

  const salesChartDailyCtx = document.getElementById('salesChartDaily').getContext('2d');

  const expensesChartMonthlyCtx = document.getElementById('expensesChartMonthly').getContext('2d');

  const expensesChartDailyCtx = document.getElementById('expensesChartDaily').getContext('2d');




  const salesChartMonthly = new Chart(salesChartMonthlyCtx, {
    type: 'bar',
    data: {
      labels: months,
      datasets: [{
        label: 'Monthly Sales',
        data: totalSales,
        backgroundColor: [

          'rgba(51, 255, 189, 0.5)'
        ],
        borderColor: [

          'rgba(0, 0, 0, 0.5)'
        ],
        borderWidth: 2

      }],
    },
    options: {
      onClick: function (event, elements) {
        if (elements.length > 0) {
          const selectedIndex = elements[0].index;
          console.log(selectedIndex);
          updateSalesChart(selectedIndex);
        }
      }
    }
  });



  function updateSalesChart(selectedIndex) {
    const updatedExpensesData = dailySalesData[months[0]].map((value, index) => (index === selectedIndex ? value : 0));
    salesChartDaily.data.datasets[0].data = updatedExpensesData;
    salesChartDaily.update();
  }



  const salesChartDaily = new Chart(salesChartDailyCtx, {
    type: 'bar',
    data: {
      labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7', 'Day 8', 'Day 9', 'Day 10', 'Day 11', 'Day 12'],
      datasets: [{
        label: 'Monthly Expenses',
        data: dailySalesData[months[0]],
        backgroundColor: [

        'rgba(51, 255, 189, 0.5)'
        ],
        borderColor: [

          'rgba(0, 0, 0, 0.5)'
        ],
        borderWidth: 2
      }],
    },
  });

  









  const expensesChartMonthly = new Chart(expensesChartMonthlyCtx, {
    type: 'bar',
    data: {
      labels: months,
      datasets: [{
        label: 'Monthly Expenses',
        data: totalExpense,
        backgroundColor: [

          'rgba(255, 87, 51, 0.5)'
        ],
        borderColor: [

          'rgba(0, 0, 0, 0.5)'
        ],
        borderWidth: 2
      }],
    },
    options: {
      onClick: function (event, elements) {
        if (elements.length > 0) {
          const selectedIndex = elements[0].index;
          console.log(selectedIndex);
          updateExpenseChart(selectedIndex);
        }
      }
    }
  });

  function updateExpenseChart(selectedIndex) {
    const updatedExpensesData = expensesData.map((value, index) => (index === selectedIndex ? value : 0));
    expensesChartDaily.data.datasets[0].data = updatedExpensesData;
    expensesChartDaily.update();
  }

  
  const expensesChartDaily = new Chart(expensesChartDailyCtx, {
    type: 'bar',
    data: {
      labels: months,
      datasets: [{
        label: 'Monthly Expenses',
        data: expensesData,
        backgroundColor: [

          'rgba(255, 87, 51, 0.5)'
        ],
        borderColor: [

          'rgba(0, 0, 0, 0.5)'
        ],
        borderWidth: 2
      }],
    },
  });


</script>

{% endblock extra_javascript %}